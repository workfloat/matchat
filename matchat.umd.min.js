/*! For license information please see matchat.umd.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("MatChat",[],e):"object"==typeof exports?exports.MatChat=e():t.MatChat=e()}(this,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>ct});const{entries:n,setPrototypeOf:o,isFrozen:i,getPrototypeOf:a,getOwnPropertyDescriptor:s}=Object;let{freeze:r,seal:l,create:c}=Object,{apply:d,construct:u}="undefined"!=typeof Reflect&&Reflect;r||(r=function(t){return t}),l||(l=function(t){return t}),d||(d=function(t,e,n){return t.apply(e,n)}),u||(u=function(t,e){return new t(...e)});const h=N(Array.prototype.forEach),p=N(Array.prototype.lastIndexOf),m=N(Array.prototype.pop),f=N(Array.prototype.push),g=N(Array.prototype.splice),y=N(String.prototype.toLowerCase),b=N(String.prototype.toString),v=N(String.prototype.match),T=N(String.prototype.replace),E=N(String.prototype.indexOf),S=N(String.prototype.trim),C=N(Object.prototype.hasOwnProperty),A=N(RegExp.prototype.test),_=(w=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(w,e)});var w;function N(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return d(t,e,o)}}function I(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;o&&o(t,null);let a=e.length;for(;a--;){let o=e[a];if("string"==typeof o){const t=n(o);t!==o&&(i(e)||(e[a]=t),o=t)}t[o]=!0}return t}function L(t){for(let e=0;e<t.length;e++){C(t,e)||(t[e]=null)}return t}function k(t){const e=c(null);for(const[o,i]of n(t)){C(t,o)&&(Array.isArray(i)?e[o]=L(i):i&&"object"==typeof i&&i.constructor===Object?e[o]=k(i):e[o]=i)}return e}function M(t,e){for(;null!==t;){const n=s(t,e);if(n){if(n.get)return N(n.get);if("function"==typeof n.value)return N(n.value)}t=a(t)}return function(){return null}}const O=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),x=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),R=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),P=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),H=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),B=r(["#text"]),U=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),z=r(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),F=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),W=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j=l(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$=l(/<%[\w\W]*|[\w\W]*%>/gm),G=l(/\$\{[\w\W]*/gm),q=l(/^data-[\-\w.\u00B7-\uFFFF]+$/),Y=l(/^aria-[\-\w]+$/),K=l(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=l(/^(?:\w+script|data):/i),V=l(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z=l(/^html$/i),J=l(/^[a-z][.\w]*(-[.\w]+)+$/i);var Q=Object.freeze({__proto__:null,ARIA_ATTR:Y,ATTR_WHITESPACE:V,CUSTOM_ELEMENT:J,DATA_ATTR:q,DOCTYPE_NAME:Z,ERB_EXPR:$,IS_ALLOWED_URI:K,IS_SCRIPT_OR_DATA:X,MUSTACHE_EXPR:j,TMPLIT_EXPR:G});const tt=1,et=3,nt=7,ot=8,it=9,at=function(){return"undefined"==typeof window?null:window};var st=function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at();const o=e=>t(e);if(o.version="3.2.5",o.removed=[],!e||!e.document||e.document.nodeType!==it||!e.Element)return o.isSupported=!1,o;let{document:i}=e;const a=i,s=a.currentScript,{DocumentFragment:l,HTMLTemplateElement:d,Node:u,Element:w,NodeFilter:N,NamedNodeMap:L=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:j,DOMParser:$,trustedTypes:G}=e,q=w.prototype,Y=M(q,"cloneNode"),X=M(q,"remove"),V=M(q,"nextSibling"),J=M(q,"childNodes"),st=M(q,"parentNode");if("function"==typeof d){const t=i.createElement("template");t.content&&t.content.ownerDocument&&(i=t.content.ownerDocument)}let rt,lt="";const{implementation:ct,createNodeIterator:dt,createDocumentFragment:ut,getElementsByTagName:ht}=i,{importNode:pt}=a;let mt={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};o.isSupported="function"==typeof n&&"function"==typeof st&&ct&&void 0!==ct.createHTMLDocument;const{MUSTACHE_EXPR:ft,ERB_EXPR:gt,TMPLIT_EXPR:yt,DATA_ATTR:bt,ARIA_ATTR:vt,IS_SCRIPT_OR_DATA:Tt,ATTR_WHITESPACE:Et,CUSTOM_ELEMENT:St}=Q;let{IS_ALLOWED_URI:Ct}=Q,At=null;const _t=I({},[...O,...x,...R,...P,...B]);let wt=null;const Nt=I({},[...U,...z,...F,...W]);let It=Object.seal(c(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Lt=null,kt=null,Mt=!0,Ot=!0,xt=!1,Rt=!0,Dt=!1,Pt=!0,Ht=!1,Bt=!1,Ut=!1,zt=!1,Ft=!1,Wt=!1,jt=!0,$t=!1,Gt=!0,qt=!1,Yt={},Kt=null;const Xt=I({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Vt=null;const Zt=I({},["audio","video","img","source","image","track"]);let Jt=null;const Qt=I({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),te="http://www.w3.org/1998/Math/MathML",ee="http://www.w3.org/2000/svg",ne="http://www.w3.org/1999/xhtml";let oe=ne,ie=!1,ae=null;const se=I({},[te,ee,ne],b);let re=I({},["mi","mo","mn","ms","mtext"]),le=I({},["annotation-xml"]);const ce=I({},["title","style","font","a","script"]);let de=null;const ue=["application/xhtml+xml","text/html"];let he=null,pe=null;const me=i.createElement("form"),fe=function(t){return t instanceof RegExp||t instanceof Function},ge=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!pe||pe!==t){if(t&&"object"==typeof t||(t={}),t=k(t),de=-1===ue.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,he="application/xhtml+xml"===de?b:y,At=C(t,"ALLOWED_TAGS")?I({},t.ALLOWED_TAGS,he):_t,wt=C(t,"ALLOWED_ATTR")?I({},t.ALLOWED_ATTR,he):Nt,ae=C(t,"ALLOWED_NAMESPACES")?I({},t.ALLOWED_NAMESPACES,b):se,Jt=C(t,"ADD_URI_SAFE_ATTR")?I(k(Qt),t.ADD_URI_SAFE_ATTR,he):Qt,Vt=C(t,"ADD_DATA_URI_TAGS")?I(k(Zt),t.ADD_DATA_URI_TAGS,he):Zt,Kt=C(t,"FORBID_CONTENTS")?I({},t.FORBID_CONTENTS,he):Xt,Lt=C(t,"FORBID_TAGS")?I({},t.FORBID_TAGS,he):{},kt=C(t,"FORBID_ATTR")?I({},t.FORBID_ATTR,he):{},Yt=!!C(t,"USE_PROFILES")&&t.USE_PROFILES,Mt=!1!==t.ALLOW_ARIA_ATTR,Ot=!1!==t.ALLOW_DATA_ATTR,xt=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Rt=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Dt=t.SAFE_FOR_TEMPLATES||!1,Pt=!1!==t.SAFE_FOR_XML,Ht=t.WHOLE_DOCUMENT||!1,zt=t.RETURN_DOM||!1,Ft=t.RETURN_DOM_FRAGMENT||!1,Wt=t.RETURN_TRUSTED_TYPE||!1,Ut=t.FORCE_BODY||!1,jt=!1!==t.SANITIZE_DOM,$t=t.SANITIZE_NAMED_PROPS||!1,Gt=!1!==t.KEEP_CONTENT,qt=t.IN_PLACE||!1,Ct=t.ALLOWED_URI_REGEXP||K,oe=t.NAMESPACE||ne,re=t.MATHML_TEXT_INTEGRATION_POINTS||re,le=t.HTML_INTEGRATION_POINTS||le,It=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&fe(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(It.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&fe(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(It.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(It.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Dt&&(Ot=!1),Ft&&(zt=!0),Yt&&(At=I({},B),wt=[],!0===Yt.html&&(I(At,O),I(wt,U)),!0===Yt.svg&&(I(At,x),I(wt,z),I(wt,W)),!0===Yt.svgFilters&&(I(At,R),I(wt,z),I(wt,W)),!0===Yt.mathMl&&(I(At,P),I(wt,F),I(wt,W))),t.ADD_TAGS&&(At===_t&&(At=k(At)),I(At,t.ADD_TAGS,he)),t.ADD_ATTR&&(wt===Nt&&(wt=k(wt)),I(wt,t.ADD_ATTR,he)),t.ADD_URI_SAFE_ATTR&&I(Jt,t.ADD_URI_SAFE_ATTR,he),t.FORBID_CONTENTS&&(Kt===Xt&&(Kt=k(Kt)),I(Kt,t.FORBID_CONTENTS,he)),Gt&&(At["#text"]=!0),Ht&&I(At,["html","head","body"]),At.table&&(I(At,["tbody"]),delete Lt.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');rt=t.TRUSTED_TYPES_POLICY,lt=rt.createHTML("")}else void 0===rt&&(rt=function(t,e){if("object"!=typeof t||"function"!=typeof t.createPolicy)return null;let n=null;const o="data-tt-policy-suffix";e&&e.hasAttribute(o)&&(n=e.getAttribute(o));const i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:t=>t,createScriptURL:t=>t})}catch(t){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(G,s)),null!==rt&&"string"==typeof lt&&(lt=rt.createHTML(""));r&&r(t),pe=t}},ye=I({},[...x,...R,...D]),be=I({},[...P,...H]),ve=function(t){f(o.removed,{element:t});try{st(t).removeChild(t)}catch(e){X(t)}},Te=function(t,e){try{f(o.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){f(o.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t)if(zt||Ft)try{ve(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},Ee=function(t){let e=null,n=null;if(Ut)t="<remove></remove>"+t;else{const e=v(t,/^[\r\n\t ]+/);n=e&&e[0]}"application/xhtml+xml"===de&&oe===ne&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const o=rt?rt.createHTML(t):t;if(oe===ne)try{e=(new $).parseFromString(o,de)}catch(t){}if(!e||!e.documentElement){e=ct.createDocument(oe,"template",null);try{e.documentElement.innerHTML=ie?lt:o}catch(t){}}const a=e.body||e.documentElement;return t&&n&&a.insertBefore(i.createTextNode(n),a.childNodes[0]||null),oe===ne?ht.call(e,Ht?"html":"body")[0]:Ht?e.documentElement:a},Se=function(t){return dt.call(t.ownerDocument||t,t,N.SHOW_ELEMENT|N.SHOW_COMMENT|N.SHOW_TEXT|N.SHOW_PROCESSING_INSTRUCTION|N.SHOW_CDATA_SECTION,null)},Ce=function(t){return t instanceof j&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof L)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Ae=function(t){return"function"==typeof u&&t instanceof u};function _e(t,e,n){h(t,(t=>{t.call(o,e,n,pe)}))}const we=function(t){let e=null;if(_e(mt.beforeSanitizeElements,t,null),Ce(t))return ve(t),!0;const n=he(t.nodeName);if(_e(mt.uponSanitizeElement,t,{tagName:n,allowedTags:At}),t.hasChildNodes()&&!Ae(t.firstElementChild)&&A(/<[/\w!]/g,t.innerHTML)&&A(/<[/\w!]/g,t.textContent))return ve(t),!0;if(t.nodeType===nt)return ve(t),!0;if(Pt&&t.nodeType===ot&&A(/<[/\w]/g,t.data))return ve(t),!0;if(!At[n]||Lt[n]){if(!Lt[n]&&Ie(n)){if(It.tagNameCheck instanceof RegExp&&A(It.tagNameCheck,n))return!1;if(It.tagNameCheck instanceof Function&&It.tagNameCheck(n))return!1}if(Gt&&!Kt[n]){const e=st(t)||t.parentNode,n=J(t)||t.childNodes;if(n&&e){for(let o=n.length-1;o>=0;--o){const i=Y(n[o],!0);i.__removalCount=(t.__removalCount||0)+1,e.insertBefore(i,V(t))}}}return ve(t),!0}return t instanceof w&&!function(t){let e=st(t);e&&e.tagName||(e={namespaceURI:oe,tagName:"template"});const n=y(t.tagName),o=y(e.tagName);return!!ae[t.namespaceURI]&&(t.namespaceURI===ee?e.namespaceURI===ne?"svg"===n:e.namespaceURI===te?"svg"===n&&("annotation-xml"===o||re[o]):Boolean(ye[n]):t.namespaceURI===te?e.namespaceURI===ne?"math"===n:e.namespaceURI===ee?"math"===n&&le[o]:Boolean(be[n]):t.namespaceURI===ne?!(e.namespaceURI===ee&&!le[o])&&!(e.namespaceURI===te&&!re[o])&&!be[n]&&(ce[n]||!ye[n]):!("application/xhtml+xml"!==de||!ae[t.namespaceURI]))}(t)?(ve(t),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!A(/<\/no(script|embed|frames)/i,t.innerHTML)?(Dt&&t.nodeType===et&&(e=t.textContent,h([ft,gt,yt],(t=>{e=T(e,t," ")})),t.textContent!==e&&(f(o.removed,{element:t.cloneNode()}),t.textContent=e)),_e(mt.afterSanitizeElements,t,null),!1):(ve(t),!0)},Ne=function(t,e,n){if(jt&&("id"===e||"name"===e)&&(n in i||n in me))return!1;if(Ot&&!kt[e]&&A(bt,e));else if(Mt&&A(vt,e));else if(!wt[e]||kt[e]){if(!(Ie(t)&&(It.tagNameCheck instanceof RegExp&&A(It.tagNameCheck,t)||It.tagNameCheck instanceof Function&&It.tagNameCheck(t))&&(It.attributeNameCheck instanceof RegExp&&A(It.attributeNameCheck,e)||It.attributeNameCheck instanceof Function&&It.attributeNameCheck(e))||"is"===e&&It.allowCustomizedBuiltInElements&&(It.tagNameCheck instanceof RegExp&&A(It.tagNameCheck,n)||It.tagNameCheck instanceof Function&&It.tagNameCheck(n))))return!1}else if(Jt[e]);else if(A(Ct,T(n,Et,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==E(n,"data:")||!Vt[t]){if(xt&&!A(Tt,T(n,Et,"")));else if(n)return!1}else;return!0},Ie=function(t){return"annotation-xml"!==t&&v(t,St)},Le=function(t){_e(mt.beforeSanitizeAttributes,t,null);const{attributes:e}=t;if(!e||Ce(t))return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:wt,forceKeepAttr:void 0};let i=e.length;for(;i--;){const a=e[i],{name:s,namespaceURI:r,value:l}=a,c=he(s);let d="value"===s?l:S(l);if(n.attrName=c,n.attrValue=d,n.keepAttr=!0,n.forceKeepAttr=void 0,_e(mt.uponSanitizeAttribute,t,n),d=n.attrValue,!$t||"id"!==c&&"name"!==c||(Te(s,t),d="user-content-"+d),Pt&&A(/((--!?|])>)|<\/(style|title)/i,d)){Te(s,t);continue}if(n.forceKeepAttr)continue;if(Te(s,t),!n.keepAttr)continue;if(!Rt&&A(/\/>/i,d)){Te(s,t);continue}Dt&&h([ft,gt,yt],(t=>{d=T(d,t," ")}));const u=he(t.nodeName);if(Ne(u,c,d)){if(rt&&"object"==typeof G&&"function"==typeof G.getAttributeType)if(r);else switch(G.getAttributeType(u,c)){case"TrustedHTML":d=rt.createHTML(d);break;case"TrustedScriptURL":d=rt.createScriptURL(d)}try{r?t.setAttributeNS(r,s,d):t.setAttribute(s,d),Ce(t)?ve(t):m(o.removed)}catch(t){}}}_e(mt.afterSanitizeAttributes,t,null)},ke=function t(e){let n=null;const o=Se(e);for(_e(mt.beforeSanitizeShadowDOM,e,null);n=o.nextNode();)_e(mt.uponSanitizeShadowNode,n,null),we(n),Le(n),n.content instanceof l&&t(n.content);_e(mt.afterSanitizeShadowDOM,e,null)};return o.sanitize=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,s=null,r=null;if(ie=!t,ie&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Ae(t)){if("function"!=typeof t.toString)throw _("toString is not a function");if("string"!=typeof(t=t.toString()))throw _("dirty is not a string, aborting")}if(!o.isSupported)return t;if(Bt||ge(e),o.removed=[],"string"==typeof t&&(qt=!1),qt){if(t.nodeName){const e=he(t.nodeName);if(!At[e]||Lt[e])throw _("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof u)n=Ee("\x3c!----\x3e"),i=n.ownerDocument.importNode(t,!0),i.nodeType===tt&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!zt&&!Dt&&!Ht&&-1===t.indexOf("<"))return rt&&Wt?rt.createHTML(t):t;if(n=Ee(t),!n)return zt?null:Wt?lt:""}n&&Ut&&ve(n.firstChild);const c=Se(qt?t:n);for(;s=c.nextNode();)we(s),Le(s),s.content instanceof l&&ke(s.content);if(qt)return t;if(zt){if(Ft)for(r=ut.call(n.ownerDocument);n.firstChild;)r.appendChild(n.firstChild);else r=n;return(wt.shadowroot||wt.shadowrootmode)&&(r=pt.call(a,r,!0)),r}let d=Ht?n.outerHTML:n.innerHTML;return Ht&&At["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&A(Z,n.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+d),Dt&&h([ft,gt,yt],(t=>{d=T(d,t," ")})),rt&&Wt?rt.createHTML(d):d},o.setConfig=function(){ge(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Bt=!0},o.clearConfig=function(){pe=null,Bt=!1},o.isValidAttribute=function(t,e,n){pe||ge({});const o=he(t),i=he(e);return Ne(o,i,n)},o.addHook=function(t,e){"function"==typeof e&&f(mt[t],e)},o.removeHook=function(t,e){if(void 0!==e){const n=p(mt[t],e);return-1===n?void 0:g(mt[t],n,1)[0]}return m(mt[t])},o.removeHooks=function(t){mt[t]=[]},o.removeAllHooks=function(){mt={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},o}(),rt=function(t,e,n,o){return new(n||(n=Promise))((function(i,a){function s(t){try{l(o.next(t))}catch(t){a(t)}}function r(t){try{l(o.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,r)}l((o=o.apply(t,e||[])).next())}))};class lt{constructor(t={}){this.isDestroyed=!1,this.boundHandlers={chatButtonClick:()=>this.handleChatButtonClick(),chatCloseClick:()=>this.handleChatClose(),sendMessageClick:()=>this.handleSendMessage(),inputKeyPress:t=>this.handleInputKeyPress(t),inputChange:()=>this.handleInputChange()},this.defaultOptions={container:document.body,position:"bottom-right",avatarUrl:"https://ui-avatars.com/api/?name=Matcha&background=4361ee&color=fff",title:"Matcha",welcomeMessage:null,theme:"serene",colors:{primary:"var(--matchat-primary-color, #6c5ce7)",primaryDark:"var(--matchat-primary-dark, #5649c0)",secondary:"var(--matchat-secondary-color, #f9fafb)",text:"var(--matchat-text-color, #1f2937)",lightText:"var(--matchat-light-text, #6b7280)"},messageBubbleStyle:{bot:{borderRadius:"4px 18px 18px 18px"},user:{borderRadius:"18px 4px 18px 18px"}},dimensions:{width:"350px",height:"500px",avatarSize:"40px",messageMaxWidth:"240px"},messageLimit:500,apiUrl:"",webhookConfig:{method:"POST",headers:{"Content-Type":"application/json"}},onMessageSend:void 0,onWidgetOpen:void 0,onWidgetClose:void 0},this.options=this.validateOptions(Object.assign(Object.assign({},this.defaultOptions),t)),"Matcha"!==this.options.title&&t.avatarUrl&&(t.avatarUrl=`https://ui-avatars.com/api/?name=${this.options.title}&background=4361ee&color=fff`),this.isOpen=!1,this.isWaitingForResponse=!1,this.sessionId=this.generateSessionId(),this.init()}validateOptions(t){return t.position&&!["bottom-right","bottom-left","top-right","top-left"].includes(t.position)&&(console.warn(`Invalid position "${t.position}". Defaulting to "bottom-right".`),t.position="bottom-right"),t.messageLimit&&("number"!=typeof t.messageLimit||t.messageLimit<=0)&&(console.warn("messageLimit must be a positive number. Using default value."),t.messageLimit=this.defaultOptions.messageLimit),t}generateSessionId(){const t=new Uint8Array(16);return crypto.getRandomValues(t),`session_${Array.from(t).map((t=>t.toString(16).padStart(2,"0"))).join("")}_${Date.now().toString(36)}`}init(){try{this.createWidget(),this.applyCustomStyles(),this.setupEventListeners(),this.options.welcomeMessage&&this.addMessage(this.options.welcomeMessage,"bot")}catch(t){console.error("Failed to initialize MatChat:",t)}}createWidget(){this.container=document.createElement("div"),this.container.className=`matchat-container matchat-${this.options.position}`,this.container.setAttribute("aria-live","polite"),this.options.container.appendChild(this.container),this.createChatButton(),this.createChatPopup()}createChatButton(){this.chatButton=document.createElement("button"),this.chatButton.className="chat-button",this.chatButton.innerHTML='<i aria-hidden="true"></i>',this.chatButton.setAttribute("aria-label","Open chat"),this.chatButton.setAttribute("role","button"),this.container.appendChild(this.chatButton)}createChatPopup(){this.chatPopup=document.createElement("div"),this.chatPopup.className="chat-popup",this.chatPopup.setAttribute("aria-modal","true"),this.chatPopup.setAttribute("role","dialog"),this.chatPopup.innerHTML=`\n      <div class="chat-header">\n        <div class="chat-header-content">\n          <img src="${this.options.avatarUrl}" alt="Chat Avatar" class="chat-avatar">\n          <h3 id="chat-title">${this.options.title}</h3>\n        </div>\n        <button class="chat-close" aria-label="Close chat">\n          <i aria-hidden="true"></i>\n        </button>\n      </div>\n      <div class="chat-messages" aria-labelledby="chat-title" aria-live="polite">\n      </div>\n      <div class="chat-input-container">\n          <div class="input-wrapper">\n              <input \n                  type="text" \n                  class="chat-input" \n                  placeholder="Type your message..." \n                  maxlength="${this.options.messageLimit}"\n                  aria-label="Type your message"\n              >\n              <div class="character-counter"></div>\n          </div>\n          <button class="send-button" aria-label="Send message">\n              <i aria-hidden="true"></i>\n          </button>\n      </div>\n    `,this.container.appendChild(this.chatPopup),this.chatMessages=this.chatPopup.querySelector(".chat-messages"),this.chatInput=this.chatPopup.querySelector(".chat-input"),this.sendButton=this.chatPopup.querySelector(".send-button"),this.chatClose=this.chatPopup.querySelector(".chat-close")}applyCustomStyles(){var t,e,n,o,i,a,s,r,l,c,d,u,h,p,m,f,g,y,b,v,T,E;const S=document.documentElement,C=(t,e)=>e&&S.style.setProperty(`--matchat-${t}`,e);if(this.options.theme&&this.container.setAttribute("data-theme",this.options.theme),"custom"===this.options.theme&&this.options.colors)return C("primary-color",this.options.colors.primary),C("primary-dark",this.options.colors.primaryDark),C("secondary-color",this.options.colors.secondary),C("text-color",this.options.colors.text),void C("light-text",this.options.colors.lightText);if(this.options.icons){const t=(t,e)=>{t.style.backgroundImage=`url('${e}')`};this.options.icons.chat&&t(this.chatButton.querySelector("i"),this.options.icons.chat),this.options.icons.close&&t(this.chatClose.querySelector("i"),this.options.icons.close),this.options.icons.send&&t(this.sendButton.querySelector("i"),this.options.icons.send)}C("primary-color",null===(t=this.options.colors)||void 0===t?void 0:t.primary),C("primary-dark",null===(e=this.options.colors)||void 0===e?void 0:e.primaryDark),C("secondary-color",null===(n=this.options.colors)||void 0===n?void 0:n.secondary),C("text-color",null===(o=this.options.colors)||void 0===o?void 0:o.text),C("light-text",null===(i=this.options.colors)||void 0===i?void 0:i.lightText),C("white",null===(a=this.options.colors)||void 0===a?void 0:a.white),C("background-image",this.options.backgroundImage),C("background-pattern",this.options.backgroundPattern),C("width",null===(s=this.options.dimensions)||void 0===s?void 0:s.width),C("height",null===(r=this.options.dimensions)||void 0===r?void 0:r.height),C("avatar-size",null===(l=this.options.dimensions)||void 0===l?void 0:l.avatarSize),C("message-max-width",null===(c=this.options.dimensions)||void 0===c?void 0:c.messageMaxWidth),C("bot-message-border-radius",null===(u=null===(d=this.options.messageBubbleStyle)||void 0===d?void 0:d.bot)||void 0===u?void 0:u.borderRadius),C("user-message-border-radius",null===(p=null===(h=this.options.messageBubbleStyle)||void 0===h?void 0:h.user)||void 0===p?void 0:p.borderRadius),C("bot-message-min-width",null===(f=null===(m=this.options.messageBubbleStyle)||void 0===m?void 0:m.bot)||void 0===f?void 0:f.minWidth),C("user-message-min-width",null===(y=null===(g=this.options.messageBubbleStyle)||void 0===g?void 0:g.user)||void 0===y?void 0:y.minWidth),C("bot-message-padding",null===(v=null===(b=this.options.messageBubbleStyle)||void 0===b?void 0:b.bot)||void 0===v?void 0:v.padding),C("user-message-padding",null===(E=null===(T=this.options.messageBubbleStyle)||void 0===T?void 0:T.user)||void 0===E?void 0:E.padding),C("position-distance",this.options.positionOffset)}setupEventListeners(){this.chatButton.addEventListener("click",this.boundHandlers.chatButtonClick),this.chatClose.addEventListener("click",this.boundHandlers.chatCloseClick),this.sendButton.addEventListener("click",this.boundHandlers.sendMessageClick),this.chatInput.addEventListener("keypress",this.boundHandlers.inputKeyPress),this.chatInput.addEventListener("input",this.boundHandlers.inputChange)}handleChatButtonClick(){this.toggleChat(),this.isOpen&&"function"==typeof this.options.onWidgetOpen&&this.options.onWidgetOpen()}handleChatClose(){this.closeChat(),"function"==typeof this.options.onWidgetClose&&this.options.onWidgetClose()}handleSendMessage(){this.sendMessage()}handleInputKeyPress(t){"Enter"===t.key&&this.sendMessage()}handleInputChange(){this.updateCharacterCount()}toggleChat(){this.isOpen=!this.isOpen,this.isOpen?this.openChat():this.closeChat()}openChat(){this.isOpen=!0,this.chatButton.classList.add("hidden"),this.chatPopup.classList.add("active"),this.chatInput.focus(),this.chatPopup.setAttribute("aria-hidden","false"),"function"==typeof this.options.onWidgetOpen&&this.options.onWidgetOpen()}closeChat(){this.isOpen=!1,this.chatPopup.classList.remove("active"),this.chatPopup.setAttribute("aria-hidden","true"),setTimeout((()=>{this.chatButton&&(this.chatButton.classList.remove("hidden"),this.chatButton.focus())}),300),"function"==typeof this.options.onWidgetClose&&this.options.onWidgetClose()}sendMessage(){const t=this.chatInput.value.trim();if(""!==t&&!this.isWaitingForResponse)if(this.addMessage(t,"user"),this.chatInput.value="",this.updateCharacterCount(),this.showTypingIndicator(),this.disableInput(),"function"==typeof this.options.onMessageSend)try{this.options.onMessageSend(t,(t=>{this.removeTypingIndicator(),this.enableInput(),this.addMessage(t,"bot")}))}catch(t){this.handleSendError()}else this.options.apiUrl?this.sendToBackend(t):this.handleDefaultResponse()}getIsOpen(){var t,e;return null!==(e=null===(t=this.chatPopup)||void 0===t?void 0:t.classList.contains("active"))&&void 0!==e?e:this.isOpen}handleDefaultResponse(){setTimeout((()=>{this.removeTypingIndicator(),this.enableInput();const t=["I understand your question. Let me check that for you.","Thanks for reaching out! How can I assist you further?","That's a great question. Here's what I can tell you...","I'm here to help! Could you provide more details?"],e=t[Math.floor(Math.random()*t.length)];this.addMessage(e,"bot")}),1500)}handleSendError(){this.removeTypingIndicator(),this.enableInput(),this.addMessage("Sorry, I'm having trouble connecting. Please try again later.","bot")}sendToBackend(t){return rt(this,void 0,void 0,(function*(){var e,n;if(!this.isDestroyed)try{const o=yield fetch(this.options.apiUrl,{method:(null===(e=this.options.webhookConfig)||void 0===e?void 0:e.method)||"POST",headers:Object.assign({"Content-Type":"application/json"},(null===(n=this.options.webhookConfig)||void 0===n?void 0:n.headers)||{}),body:JSON.stringify({message:t,sessionId:this.sessionId,timestamp:(new Date).toISOString()})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const i=yield o.json();this.removeTypingIndicator(),this.enableInput();const a=i.response||i.message||i.reply||"Thanks for your message! We'll get back to you soon.",s=i.formattedResponse?i.formattedResponse:this.formatMessage(a,"bot");this.addMessage(s,"bot")}catch(t){console.error("Error sending message:",t),this.isDestroyed||this.handleSendError()}}))}addMessage(t,e){if(!this.isDestroyed&&this.chatMessages)try{const n=document.createElement("div");n.classList.add("message",`${e}-message`),n.setAttribute("aria-label",`${e} message`);const o=document.createElement("div");o.className="message-content";const i=this.formatMessage(t,e);o.innerHTML=i,n.appendChild(o);const a=document.createElement("div");a.classList.add("timestamp"),a.textContent=this.getCurrentTime(),n.appendChild(a),this.chatMessages.appendChild(n),this.scrollToBottom()}catch(t){console.error("Failed to add message:",t)}}formatMessage(t,e){if("string"!=typeof t)return"";let n="";if("user"===e){const e=this.escapeHtml(t);n=this.markdownToHtml(e)}return"bot"===e&&(n=this.markdownToHtml(t),n=this.sanitizeHtml(n)),n=n.replace(/\n/g,"<br>"),n}escapeHtml(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,(t=>e[t]))}markdownToHtml(t){return(t=(t=t.replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>")).replace(/`([^`]+)`/g,"<code>$1</code>")).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>').replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>")}sanitizeHtml(t){return st.sanitize(t,{ALLOWED_TAGS:["strong","em","a","code","pre","br","p","ul","ol","li"],ALLOWED_ATTR:["href","target","rel"]})}showTypingIndicator(){this.removeTypingIndicator();const t=document.createElement("div");t.classList.add("typing-indicator"),t.id="typingIndicator",t.setAttribute("aria-label","Bot is typing");for(let e=0;e<3;e++){const e=document.createElement("div");e.classList.add("typing-dot"),t.appendChild(e)}this.chatMessages.appendChild(t),this.scrollToBottom()}removeTypingIndicator(){const t=document.getElementById("typingIndicator");t&&t.remove()}disableInput(){this.isWaitingForResponse=!0,this.chatInput.disabled=!0,this.sendButton.disabled=!0,this.chatInput.setAttribute("aria-busy","true")}enableInput(){this.isWaitingForResponse=!1,this.chatInput.disabled=!1,this.sendButton.disabled=!1,this.chatInput.removeAttribute("aria-busy"),this.chatInput.focus()}updateCharacterCount(){var t;const e=null===(t=this.chatInput.parentElement)||void 0===t?void 0:t.querySelector(".character-counter");e&&e.remove();const n=this.chatInput.value.length;if(n>0&&this.chatInput.parentElement){const t=document.createElement("div");t.className="character-counter",t.textContent=`${n}/${this.options.messageLimit}`,this.chatInput.parentElement.appendChild(t)}}scrollToBottom(){this.chatMessages.scrollTop=this.chatMessages.scrollHeight}getCurrentTime(){return(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}destroy(){var t,e,n,o,i,a;this.isDestroyed=!0;try{null===(t=this.chatButton)||void 0===t||t.removeEventListener("click",this.boundHandlers.chatButtonClick),null===(e=this.chatClose)||void 0===e||e.removeEventListener("click",this.boundHandlers.chatCloseClick),null===(n=this.sendButton)||void 0===n||n.removeEventListener("click",this.boundHandlers.sendMessageClick),null===(o=this.chatInput)||void 0===o||o.removeEventListener("keypress",this.boundHandlers.inputKeyPress),null===(i=this.chatInput)||void 0===i||i.removeEventListener("input",this.boundHandlers.inputChange),this.boundHandlers={},(null===(a=this.container)||void 0===a?void 0:a.parentNode)&&this.container.parentNode.removeChild(this.container),this.container=null,this.chatButton=null,this.chatPopup=null,this.chatMessages=null,this.chatInput=null,this.sendButton=null,this.chatClose=null}catch(t){console.error("Failed to destroy MatChat:",t)}}}"undefined"!=typeof window&&(window.MatChat=lt);const ct=lt;return e=e.default})()));